<div class="item-page" style="height: auto !important;"><div class="page-header"><h1>How to Write Excel Files in Java using Apache POI</h1></div><div class="article-info muted"><dl class="article-info"><dt class="article-info-term">Details</dt><dd class="createdby">Written by &nbsp;<cite><a href="/nam-ha-minh" rel="author">Nam Ha Minh</a></cite></dd><dd class="modified"><span class="icon-calendar"></span> Last Updated on 30 May 2019						&nbsp; | &nbsp;<a href="/coding/how-to-write-excel-files-in-java-using-apache-poi?tmpl=component&amp;print=1&amp;page=" title="Print" onclick="window.open(this.href,'win2','status=no,toolbar=no,scrollbars=yes,titlebar=no,menubar=no,resizable=yes,width=640,height=480,directories=no,location=no'); return false;" rel="nofollow"><span class="icon-print"></span>&nbsp;Print&nbsp;</a><a href="/component/mailto/?tmpl=component&amp;template=protostar&amp;link=e6c1ad967b86075ba90ca8cf6747053ee79ed3f5" title="Email" onclick="window.open(this.href,'win2','width=400,height=350,menubar=yes,resizable=yes'); return false;"><span class="icon-envelope"></span> Email</a></dd></dl></div><div style="height: auto !important;"><br><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><!-- Before Content Ads --><ins class="adsbygoogle" style="display: block; height: 280px;" data-ad-client="ca-pub-0752457374863186" data-ad-slot="2953175283" data-ad-format="auto" data-full-width-responsive="true" data-adsbygoogle-status="done" data-ad-status="filled"><ins id="aswift_1_expand" tabindex="0" title="Advertisement" aria-label="Advertisement" style="border: none; height: 280px; width: 788px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-table;"><ins id="aswift_1_anchor" style="border: none; height: 280px; width: 788px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: block; overflow: visible;"><iframe id="aswift_1" name="aswift_1" style="left:0;position:absolute;top:0;border:0;width:788px;height:280px;" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" width="788" height="280" frameborder="0" src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-0752457374863186&amp;output=html&amp;h=280&amp;slotname=2953175283&amp;adk=320047272&amp;adf=3286556317&amp;pi=t.ma~as.2953175283&amp;w=788&amp;fwrn=4&amp;fwrnh=100&amp;lmt=1632435986&amp;rafmt=1&amp;psa=1&amp;format=788x280&amp;url=https%3A%2F%2Fwww.codejava.net%2Fcoding%2Fhow-to-write-excel-files-in-java-using-apache-poi&amp;flash=0&amp;fwr=0&amp;fwrattr=true&amp;rpe=1&amp;resp_fmts=3&amp;wgl=1&amp;uach=WyJtYWNPUyIsIjEwLjE1LjciLCJ4ODYiLCIiLCI5My4wLjQ1NzcuODIiLFtdLG51bGwsbnVsbCwiNjQiXQ..&amp;tt_state=W3siaXNzdWVyT3JpZ2luIjoiaHR0cHM6Ly9hdHRlc3RhdGlvbi5hbmRyb2lkLmNvbSIsInN0YXRlIjo3fV0.&amp;dt=1632435986149&amp;bpp=3&amp;bdt=435&amp;idt=279&amp;shv=r20210921&amp;mjsv=m202109200201&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;cookie=ID%3D46ca8b6d0a7d9a4e-22f06611c8cb0068%3AT%3D1632430051%3ART%3D1632430051%3AS%3DALNI_MZIOjrhzHkOQYSkb_0iMyrGnt6hAw&amp;prev_fmts=221x600&amp;correlator=2927262779965&amp;frm=20&amp;pv=1&amp;ga_vid=1513118644.1632430051&amp;ga_sid=1632435986&amp;ga_hid=1208409766&amp;ga_fc=0&amp;u_tz=420&amp;u_his=3&amp;u_h=1200&amp;u_w=1920&amp;u_ah=1200&amp;u_aw=1920&amp;u_cd=24&amp;adx=548&amp;ady=230&amp;biw=1675&amp;bih=1032&amp;scr_x=0&amp;scr_y=0&amp;eid=31062519%2C21067496&amp;oid=3&amp;pvsid=258817578414794&amp;pem=639&amp;ref=https%3A%2F%2Fwww.google.com%2F&amp;eae=0&amp;fc=896&amp;brdim=169%2C0%2C169%2C0%2C1920%2C0%2C1690%2C1200%2C1690%2C1032&amp;vis=1&amp;rsz=%7C%7CeE%7C&amp;abl=CS&amp;pfx=0&amp;fu=128&amp;bc=31&amp;ifi=2&amp;uci=a!2&amp;fsb=1&amp;xpc=dw5mDVHtPj&amp;p=https%3A//www.codejava.net&amp;dtd=304" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" data-google-container-id="a!2" data-google-query-id="CLCw4viRlvMCFbGJ5godC6oIbA" data-load-complete="true"></iframe></ins></ins></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><br></div>In this tutorial, I’d love to share with you guys some examples of writing data to Excel files using the <a href="https://poi.apache.org/" rel="nofollow" target="_blank">Apache POI</a> library. If today is the first day you get to know Apache POI and you haven’t written any code snippet to read/write Excel files yet, I recommend you to read the sections 1 and 2 in the tutorial <a href="/coding/how-to-read-excel-files-in-java-using-apache-poi" target="_blank">How to Read Excel Files in Java using Apache POI</a> to understand the fundamentals of Apache POI.<p></p>Or if you are a kind of person who likes getting your hands-dirty first, let jump directly into the following examples.<p></p>&nbsp;<p></p><h2><strong><span style="font-size: 16pt; line-height: 115%;">1. Apache POI API Basics for Writing Excel Files</span></strong></h2>The fundamental interfaces include <span style="color: #800000;"><strong><span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';">Workbook</span></strong></span>, <span style="color: #800000;"><strong><span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';">Sheet</span></strong></span>, <span style="color: #800000;"><strong><span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';">Row&nbsp;</span></strong></span>and <span style="color: #800000;"><strong><span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';">Cell</span></strong></span>. For basic formatting, use the <span style="color: #800000;"><strong><span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';">CellStyle&nbsp;</span></strong></span>and <span style="color: #800000;"><strong><span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';">Font&nbsp;</span></strong></span>interfaces. Concrete implementing classes include:<p></p><ul><li>Excel 2003: <span style="color: #800000;"><strong><span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';">HSSFWorkbook</span></strong></span>, <span style="color: #800000;"><strong><span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';">HSSFSheet</span></strong></span>, <span style="color: #800000;"><strong><span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';">HSSFRow</span></strong></span>, <span style="color: #800000;"><strong><span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';">HSSFCell</span></strong></span>, etc.</li><li>Excel 2007: <span style="color: #800000;"><strong><span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';">XSSFWorkbook</span></strong></span>, <span style="color: #800000;"><strong><span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';">XSSFSheet</span></strong></span>, <span style="color: #800000;"><strong><span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';">XSSFRow</span></strong></span>, <span style="color: #800000;"><strong><span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';">XSSFCell</span></strong></span>, etc.</li></ul>But I recommend using the common interfaces for greater flexibility with both Excel formats 2003 (XLS) and 2007(XLSX).<p></p>Here are the basic steps for writing an Excel file:<p></p><ol><li>Create a <span style="color: #800000;"><strong><span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';">Workbook</span></strong></span>.</li><li>Create a <span style="color: #800000;"><strong><span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';">Sheet</span></strong></span>.</li><li>Repeat the following steps until all data is processed:<ol style="list-style-type: lower-alpha;"><li>Create a <span style="color: #800000;"><strong><span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';">Row</span></strong></span>.</li><li>Create <span style="color: #800000;"><strong><span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';">Cells</span></strong></span>in a <strong><span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';">Row</span></strong>. Apply formatting using <span style="color: #800000;"><strong><span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';">CellStyle</span></strong></span>.</li></ol></li><li>Write to an <span style="color: #800000;"><strong><span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';">OutputStream</span></strong></span>.</li><li>Close the output stream.</li></ol>Now, let’s see some examples that demonstrate writing a list of books to an Excel file.<p></p>&nbsp;<p></p><h2><strong><span style="font-size: 16pt; line-height: 115%;">2. A Simple Example to create an Excel file in Java</span></strong></h2>The following code snippet is a very simple program that demonstrates writing a list of books to an Excel file in the simplest and dirty form:<p></p><div><div id="highlighter_261584" class="syntaxhighlighter  java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">package</code> <code class="java plain">net.codejava.excel;</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="java keyword">import</code> <code class="java plain">java.io.FileOutputStream;</code></div><div class="line number4 index3 alt1"><code class="java keyword">import</code> <code class="java plain">java.io.IOException;</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="java keyword">import</code> <code class="java plain">org.apache.poi.ss.usermodel.Cell;</code></div><div class="line number7 index6 alt2"><code class="java keyword">import</code> <code class="java plain">org.apache.poi.ss.usermodel.Row;</code></div><div class="line number8 index7 alt1"><code class="java keyword">import</code> <code class="java plain">org.apache.poi.xssf.usermodel.XSSFSheet;</code></div><div class="line number9 index8 alt2"><code class="java keyword">import</code> <code class="java plain">org.apache.poi.xssf.usermodel.XSSFWorkbook;</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="java preprocessor">/**</code></div><div class="line number12 index11 alt1"><code class="java spaces">&nbsp;</code><code class="java preprocessor">* A very simple program that writes some data to an Excel file</code></div><div class="line number13 index12 alt2"><code class="java spaces">&nbsp;</code><code class="java preprocessor">* using the Apache POI library.</code></div><div class="line number14 index13 alt1"><code class="java spaces">&nbsp;</code><code class="java preprocessor">* @author www.codejava.net</code></div><div class="line number15 index14 alt2"><code class="java spaces">&nbsp;</code><code class="java preprocessor">*</code></div><div class="line number16 index15 alt1"><code class="java spaces">&nbsp;</code><code class="java preprocessor">*/</code></div><div class="line number17 index16 alt2"><code class="java keyword">public</code> <code class="java keyword">class</code> <code class="java plain">SimpleExcelWriterExample {</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java keyword">static</code> <code class="java keyword">void</code> <code class="java plain">main(String[] args) </code><code class="java keyword">throws</code> <code class="java plain">IOException {</code></div><div class="line number20 index19 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">XSSFWorkbook workbook = </code><code class="java keyword">new</code> <code class="java plain">XSSFWorkbook();</code></div><div class="line number21 index20 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">XSSFSheet sheet = workbook.createSheet(</code><code class="java string">"Java Books"</code><code class="java plain">);</code></div><div class="line number22 index21 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number23 index22 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Object[][] bookData = {</code></div><div class="line number24 index23 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">{</code><code class="java string">"Head First Java"</code><code class="java plain">, </code><code class="java string">"Kathy Serria"</code><code class="java plain">, </code><code class="java value">79</code><code class="java plain">},</code></div><div class="line number25 index24 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">{</code><code class="java string">"Effective Java"</code><code class="java plain">, </code><code class="java string">"Joshua Bloch"</code><code class="java plain">, </code><code class="java value">36</code><code class="java plain">},</code></div><div class="line number26 index25 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">{</code><code class="java string">"Clean Code"</code><code class="java plain">, </code><code class="java string">"Robert martin"</code><code class="java plain">, </code><code class="java value">42</code><code class="java plain">},</code></div><div class="line number27 index26 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">{</code><code class="java string">"Thinking in Java"</code><code class="java plain">, </code><code class="java string">"Bruce Eckel"</code><code class="java plain">, </code><code class="java value">35</code><code class="java plain">},</code></div><div class="line number28 index27 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">};</code></div><div class="line number29 index28 alt2">&nbsp;</div><div class="line number30 index29 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">int</code> <code class="java plain">rowCount = </code><code class="java value">0</code><code class="java plain">;</code></div><div class="line number31 index30 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number32 index31 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">for</code> <code class="java plain">(Object[] aBook : bookData) {</code></div><div class="line number33 index32 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Row row = sheet.createRow(++rowCount);</code></div><div class="line number34 index33 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number35 index34 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">int</code> <code class="java plain">columnCount = </code><code class="java value">0</code><code class="java plain">;</code></div><div class="line number36 index35 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number37 index36 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">for</code> <code class="java plain">(Object field : aBook) {</code></div><div class="line number38 index37 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Cell cell = row.createCell(++columnCount);</code></div><div class="line number39 index38 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code> <code class="java plain">(field </code><code class="java keyword">instanceof</code> <code class="java plain">String) {</code></div><div class="line number40 index39 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">cell.setCellValue((String) field);</code></div><div class="line number41 index40 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">} </code><code class="java keyword">else</code> <code class="java keyword">if</code> <code class="java plain">(field </code><code class="java keyword">instanceof</code> <code class="java plain">Integer) {</code></div><div class="line number42 index41 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">cell.setCellValue((Integer) field);</code></div><div class="line number43 index42 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number44 index43 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number45 index44 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number46 index45 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number47 index46 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number48 index47 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number49 index48 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code> <code class="java plain">(FileOutputStream outputStream = </code><code class="java keyword">new</code> <code class="java plain">FileOutputStream(</code><code class="java string">"JavaBooks.xlsx"</code><code class="java plain">)) {</code></div><div class="line number50 index49 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">workbook.write(outputStream);</code></div><div class="line number51 index50 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number52 index51 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number53 index52 alt2">&nbsp;</div><div class="line number54 index53 alt1"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div><div style="height: auto !important;"><br><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><!-- Inside Content Ads --><ins class="adsbygoogle" style="display: block; height: 280px;" data-ad-client="ca-pub-0752457374863186" data-ad-slot="7189273158" data-ad-format="auto" data-full-width-responsive="true" data-adsbygoogle-status="done" data-ad-status="filled"><ins id="aswift_2_expand" tabindex="0" title="Advertisement" aria-label="Advertisement" style="border: none; height: 280px; width: 788px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-table;"><ins id="aswift_2_anchor" style="border: none; height: 280px; width: 788px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: block; overflow: visible;"><iframe id="aswift_2" name="aswift_2" style="left:0;position:absolute;top:0;border:0;width:788px;height:280px;" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" width="788" height="280" frameborder="0" src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-0752457374863186&amp;output=html&amp;h=280&amp;slotname=7189273158&amp;adk=844106988&amp;adf=1286702316&amp;pi=t.ma~as.7189273158&amp;w=788&amp;fwrn=4&amp;fwrnh=100&amp;lmt=1632435986&amp;rafmt=1&amp;psa=1&amp;format=788x280&amp;url=https%3A%2F%2Fwww.codejava.net%2Fcoding%2Fhow-to-write-excel-files-in-java-using-apache-poi&amp;flash=0&amp;fwr=0&amp;fwrattr=true&amp;rpe=1&amp;resp_fmts=3&amp;wgl=1&amp;uach=WyJtYWNPUyIsIjEwLjE1LjciLCJ4ODYiLCIiLCI5My4wLjQ1NzcuODIiLFtdLG51bGwsbnVsbCwiNjQiXQ..&amp;tt_state=W3siaXNzdWVyT3JpZ2luIjoiaHR0cHM6Ly9hdHRlc3RhdGlvbi5hbmRyb2lkLmNvbSIsInN0YXRlIjo3fV0.&amp;dt=1632435986153&amp;bpp=4&amp;bdt=439&amp;idt=346&amp;shv=r20210921&amp;mjsv=m202109200201&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;cookie=ID%3D46ca8b6d0a7d9a4e-22f06611c8cb0068%3AT%3D1632430051%3ART%3D1632430051%3AS%3DALNI_MZIOjrhzHkOQYSkb_0iMyrGnt6hAw&amp;prev_fmts=221x600%2C788x280&amp;correlator=2927262779965&amp;frm=20&amp;pv=1&amp;ga_vid=1513118644.1632430051&amp;ga_sid=1632435986&amp;ga_hid=1208409766&amp;ga_fc=0&amp;u_tz=420&amp;u_his=3&amp;u_h=1200&amp;u_w=1920&amp;u_ah=1200&amp;u_aw=1920&amp;u_cd=24&amp;adx=548&amp;ady=2215&amp;biw=1675&amp;bih=1032&amp;scr_x=0&amp;scr_y=0&amp;eid=31062519%2C21067496&amp;oid=3&amp;pvsid=258817578414794&amp;pem=639&amp;ref=https%3A%2F%2Fwww.google.com%2F&amp;eae=0&amp;fc=896&amp;brdim=169%2C0%2C169%2C0%2C1920%2C0%2C1690%2C1200%2C1690%2C1032&amp;vis=1&amp;rsz=%7C%7CeEbr%7C&amp;abl=CS&amp;pfx=0&amp;fu=128&amp;bc=31&amp;ifi=3&amp;uci=a!3&amp;btvi=2&amp;fsb=1&amp;xpc=ysPooQoAy3&amp;p=https%3A//www.codejava.net&amp;dtd=354" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" data-google-container-id="a!3" data-google-query-id="CIOJ5fiRlvMCFVcNtwAdjkED4A" data-load-complete="true"></iframe></ins></ins></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><br></div>This program creates an Excel 2007 document which looks like the following screenshot (File: <span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';">JavaBooks.xlsx</span>):<p></p><img loading="lazy" style="display: block; margin-left: auto; margin-right: auto;" src="/images/articles/misc/write-excel/Output_Excel_File.png" alt="Output Excel File" width="360" height="156"><p></p>&nbsp;<p></p><h2><strong><span style="font-size: 16pt; line-height: 115%;">3. A More Object-Oriented Example to create an Excel file in Java</span></strong></h2>The following code snippets demonstrate a nicer program that focuses on OOP approach. That makes the program more flexible and easy to extend or upgrade in the future.<p></p><ul><li>Create the model class (<strong><span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';">Book.java</span></strong>):<div><div id="highlighter_115136" class="syntaxhighlighter  java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">package</code> <code class="java plain">net.codejava.excel;</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="java keyword">public</code> <code class="java keyword">class</code> <code class="java plain">Book {</code></div><div class="line number4 index3 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code> <code class="java plain">String title;</code></div><div class="line number5 index4 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code> <code class="java plain">String author;</code></div><div class="line number6 index5 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code> <code class="java keyword">float</code> <code class="java plain">price;</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java plain">Book() {</code></div><div class="line number9 index8 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java plain">Book(String title, String author, </code><code class="java keyword">double</code> <code class="java plain">price) {</code></div><div class="line number12 index11 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">this</code><code class="java plain">.title = title;</code></div><div class="line number13 index12 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">this</code><code class="java plain">.author = author;</code></div><div class="line number14 index13 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">this</code><code class="java plain">.price = price;</code></div><div class="line number15 index14 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">// getters and setters</code></div><div class="line number18 index17 alt1"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div></li><li>The method that writes a list of books to an Excel file (in 2003 format):<div><div id="highlighter_57649" class="syntaxhighlighter  java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">public</code> <code class="java keyword">void</code> <code class="java plain">writeExcel(List&lt;Book&gt; listBook, String excelFilePath) </code><code class="java keyword">throws</code> <code class="java plain">IOException {</code></div><div class="line number2 index1 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Workbook workbook = </code><code class="java keyword">new</code> <code class="java plain">HSSFWorkbook();</code></div><div class="line number3 index2 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Sheet sheet = workbook.createSheet();</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">int</code> <code class="java plain">rowCount = </code><code class="java value">0</code><code class="java plain">;</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">for</code> <code class="java plain">(Book aBook : listBook) {</code></div><div class="line number8 index7 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Row row = sheet.createRow(++rowCount);</code></div><div class="line number9 index8 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">writeBook(aBook, row);</code></div><div class="line number10 index9 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code> <code class="java plain">(FileOutputStream outputStream = </code><code class="java keyword">new</code> <code class="java plain">FileOutputStream(excelFilePath)) {</code></div><div class="line number13 index12 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">workbook.write(outputStream);</code></div><div class="line number14 index13 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number15 index14 alt2"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div></li><li>The method that writes information of a book to cells:<div><div id="highlighter_126984" class="syntaxhighlighter  java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">private</code> <code class="java keyword">void</code> <code class="java plain">writeBook(Book aBook, Row row) {</code></div><div class="line number2 index1 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Cell cell = row.createCell(</code><code class="java value">1</code><code class="java plain">);</code></div><div class="line number3 index2 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">cell.setCellValue(aBook.getTitle());</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">cell = row.createCell(</code><code class="java value">2</code><code class="java plain">);</code></div><div class="line number6 index5 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">cell.setCellValue(aBook.getAuthor());</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">cell = row.createCell(</code><code class="java value">3</code><code class="java plain">);</code></div><div class="line number9 index8 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">cell.setCellValue(aBook.getPrice());</code></div><div class="line number10 index9 alt1"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div></li><li>The following method creates some dummy data (a list of books):<div><div id="highlighter_563679" class="syntaxhighlighter  java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">private</code> <code class="java plain">List&lt;Book&gt; getListBook() {</code></div><div class="line number2 index1 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Book book1 = </code><code class="java keyword">new</code> <code class="java plain">Book(</code><code class="java string">"Head First Java"</code><code class="java plain">, </code><code class="java string">"Kathy Serria"</code><code class="java plain">, </code><code class="java value">79</code><code class="java plain">);</code></div><div class="line number3 index2 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Book book2 = </code><code class="java keyword">new</code> <code class="java plain">Book(</code><code class="java string">"Effective Java"</code><code class="java plain">, </code><code class="java string">"Joshua Bloch"</code><code class="java plain">, </code><code class="java value">36</code><code class="java plain">);</code></div><div class="line number4 index3 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Book book3 = </code><code class="java keyword">new</code> <code class="java plain">Book(</code><code class="java string">"Clean Code"</code><code class="java plain">, </code><code class="java string">"Robert Martin"</code><code class="java plain">, </code><code class="java value">42</code><code class="java plain">);</code></div><div class="line number5 index4 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Book book4 = </code><code class="java keyword">new</code> <code class="java plain">Book(</code><code class="java string">"Thinking in Java"</code><code class="java plain">, </code><code class="java string">"Bruce Eckel"</code><code class="java plain">, </code><code class="java value">35</code><code class="java plain">);</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">List&lt;Book&gt; listBook = Arrays.asList(book1, book2, book3, book4);</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code> <code class="java plain">listBook;</code></div><div class="line number10 index9 alt1"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div></li><li>And the following code snippet is for testing:<div><div id="highlighter_428149" class="syntaxhighlighter  java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java plain">NiceExcelWriterExample excelWriter = </code><code class="java keyword">new</code> <code class="java plain">NiceExcelWriterExample();</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="java plain">List&lt;Book&gt; listBook = excelWriter.getListBook();</code></div><div class="line number4 index3 alt1"><code class="java plain">String excelFilePath = </code><code class="java string">"NiceJavaBooks.xls"</code><code class="java plain">;</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="java plain">excelWriter.writeExcel(listBook, excelFilePath);</code></div></div></td></tr></tbody></table></div></div></li></ul>&nbsp;<p></p><h2><strong><span style="font-size: 16pt; line-height: 115%;">4. Formatting Cells of the Excel file</span></strong></h2>Of course you may need to format the Excel file to make it looks nicely and professionally. Formatting is diversity and quite complex so in this introductory tutorial, I just show you how to format the basics like setting font style. Here are the steps:<p></p><ul><li>Create a <strong><span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';">CellStyle</span></strong> object what holds formatting information:<div><div id="highlighter_344517" class="syntaxhighlighter  java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java plain">CellStyle cellStyle = sheet.getWorkbook().createCellStyle();</code></div></div></td></tr></tbody></table></div></div></li><li>Invoke the appropriate setters to apply the formatting you want. For example:<div><div id="highlighter_415292" class="syntaxhighlighter  java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java plain">cellStyle.setAlignment(CellStyle.ALIGN_CENTER);</code></div><div class="line number2 index1 alt1"><code class="java plain">cellStyle.setFont(font);</code></div><div class="line number3 index2 alt2"><code class="java plain">cellStyle.setWrapText(</code><code class="java keyword">true</code><code class="java plain">);</code></div></div></td></tr></tbody></table></div></div></li></ul>For example, the following method writes a header row for the document with font style bold and size is 16:<p></p><div><div id="highlighter_438551" class="syntaxhighlighter  java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">private</code> <code class="java keyword">void</code> <code class="java plain">createHeaderRow(Sheet sheet) {</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">CellStyle cellStyle = sheet.getWorkbook().createCellStyle();</code></div><div class="line number4 index3 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Font font = sheet.getWorkbook().createFont();</code></div><div class="line number5 index4 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">font.setBold(</code><code class="java keyword">true</code><code class="java plain">);</code></div><div class="line number6 index5 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">font.setFontHeightInPoints((</code><code class="java keyword">short</code><code class="java plain">) </code><code class="java value">16</code><code class="java plain">);</code></div><div class="line number7 index6 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">cellStyle.setFont(font);</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Row row = sheet.createRow(</code><code class="java value">0</code><code class="java plain">);</code></div><div class="line number10 index9 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Cell cellTitle = row.createCell(</code><code class="java value">1</code><code class="java plain">);</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">cellTitle.setCellStyle(cellStyle);</code></div><div class="line number13 index12 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">cellTitle.setCellValue(</code><code class="java string">"Title"</code><code class="java plain">);</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Cell cellAuthor = row.createCell(</code><code class="java value">2</code><code class="java plain">);</code></div><div class="line number16 index15 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">cellAuthor.setCellStyle(cellStyle);</code></div><div class="line number17 index16 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">cellAuthor.setCellValue(</code><code class="java string">"Author"</code><code class="java plain">);</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Cell cellPrice = row.createCell(</code><code class="java value">3</code><code class="java plain">);</code></div><div class="line number20 index19 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">cellPrice.setCellStyle(cellStyle);</code></div><div class="line number21 index20 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">cellPrice.setCellValue(</code><code class="java string">"Price"</code><code class="java plain">);</code></div><div class="line number22 index21 alt1"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div>You can see the complete program (<span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';">FormattedExcelWriterExample.java</span>) which can be found in the source code attached to this article.<p></p>&nbsp;<p></p><h2><strong><span style="font-size: 16pt; line-height: 115%;">5. Writing both Excel 2003 and Excel 2007 formats in Java</span></strong></h2>For better flexibility (supporting both common Excel formats), I recommend writing a factory method that either returns a <span style="color: #800000;"><strong><span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';">HSSFWorkbook</span></strong></span> or <span style="color: #800000;"><strong><span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';">XSSFWorkbook</span></strong></span>, depending on the extension of the file (<span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New'; color: #800000;">.xls</span> or <span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New'; color: #800000;">.xlsx</span>). Here’s the method:<p></p><div><div id="highlighter_995345" class="syntaxhighlighter  java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">private</code> <code class="java plain">Workbook getWorkbook(String excelFilePath)</code></div><div class="line number2 index1 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">throws</code> <code class="java plain">IOException {</code></div><div class="line number3 index2 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Workbook workbook = </code><code class="java keyword">null</code><code class="java plain">;</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code> <code class="java plain">(excelFilePath.endsWith(</code><code class="java string">"xlsx"</code><code class="java plain">)) {</code></div><div class="line number6 index5 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">workbook = </code><code class="java keyword">new</code> <code class="java plain">XSSFWorkbook();</code></div><div class="line number7 index6 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">} </code><code class="java keyword">else</code> <code class="java keyword">if</code> <code class="java plain">(excelFilePath.endsWith(</code><code class="java string">"xls"</code><code class="java plain">)) {</code></div><div class="line number8 index7 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">workbook = </code><code class="java keyword">new</code> <code class="java plain">HSSFWorkbook();</code></div><div class="line number9 index8 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">} </code><code class="java keyword">else</code> <code class="java plain">{</code></div><div class="line number10 index9 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">throw</code> <code class="java keyword">new</code> <code class="java plain">IllegalArgumentException(</code><code class="java string">"The specified file is not Excel file"</code><code class="java plain">);</code></div><div class="line number11 index10 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code> <code class="java plain">workbook;</code></div><div class="line number14 index13 alt1"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div>You can see the complete program (<span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';">FlexibleExcelWriterExample.java</span>) which can be found in the source code attached to this article.<p></p>That's how to read Excel files in Java programmatically. To learn more in-depth about Java programming, this <a href="https://click.linksynergy.com/link?id=d1Fh24*EiQI&amp;offerid=323058.533682&amp;type=2&amp;murl=https%3A%2F%2Fwww.udemy.com%2Fjava-the-complete-java-developer-course%2F&amp;u1=WebFooter" rel="nofollow" target="_blank">Java software developers course</a> would be good choice.<p></p><h3>&nbsp;</h3><h3>Related Java Excel Tutorials:</h3><ul><li><a href="/coding/how-to-read-excel-files-in-java-using-apache-poi" target="_blank">How to Read Excel Files in Java using Apache POI</a></li><li><a href="/coding/java-example-to-read-password-protected-excel-files-using-apache-poi" target="_blank">Java Example to Read Password-protected Excel Files Using Apache POI</a></li><li><a href="/coding/java-example-to-update-existing-excel-files-using-apache-poi" target="_blank">Java Example to Update Existing Excel Files Using Apache POI</a></li><li><a href="/coding/working-with-formula-cells-in-excel-using-apache-poi" target="_blank">Working with Formula Cells in Excel using Apache POI</a></li></ul>&nbsp;<p></p><h3><strong><span style="font-size: 12pt; line-height: 115%;">References</span></strong></h3><ul><li><a href="https://poi.apache.org" rel="nofollow" target="_blank">Apache POI - the Java API for Microsoft Documents</a></li><li><a href="https://poi.apache.org/apidocs/index.html" rel="nofollow" target="_blank">POI API Documentation (Javadocs)</a></li><li><a href="https://poi.apache.org/spreadsheet/quick-guide.html" rel="nofollow" target="_blank">Apache POI Quick Guide</a></li><li><a href="https://poi.apache.org/spreadsheet/how-to.html" rel="nofollow" target="_blank">Apache POI HOWTO</a></li></ul>&nbsp;<p></p><div><br><h3>About the Author:</h3><img loading="lazy" width="80" height="80" src="/images/NamAuthor.png" align="left" style="padding: 0px 10px 15px 0px"><cite><a href="/nam-ha-minh" target="_blank" rel="author">Nam Ha Minh</a></cite> is certified Java programmer (SCJP and SCWCD). He started programming with Java in the time of Java 1.4 and has been falling in love with Java since then. Make friend with him on <a href="https://www.facebook.com/namjavaprogrammer" rel="nofollow" target="_blank">Facebook</a> and watch <a href="https://www.youtube.com/codejava?utm_source=codejava&amp;utm_campaign=aboutnamhm" rel="nofollow" target="_blank">his Java videos</a> you YouTube.<br><br><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><!-- Content Bottom Ads --><ins class="adsbygoogle" style="display: block; height: 280px;" data-ad-client="ca-pub-0752457374863186" data-ad-slot="6522865221" data-ad-format="auto" data-full-width-responsive="true" data-adsbygoogle-status="done"><ins id="aswift_3_expand" style="border: none; height: 280px; width: 788px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-table;"><ins id="aswift_3_anchor" style="border: none; height: 280px; width: 788px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: block;"></ins></ins></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><br><br></div><div class="attachmentsContainer"><div class="attachmentsList" id="attachmentsList_com_content_article_554"><table><caption>Attachments:</caption><tbody><tr class="odd"><td class="at_filename"><a class="at_icon" href="/download-attachment?fid=341" target="_blank" title="Download this file (ExcelFilesWriterExamples.zip)"><img src="/media/com_attachments/images/file_icons/zip.gif" alt="Download this file (ExcelFilesWriterExamples.zip)" loading="lazy" width="16" height="16"></a><a class="at_url" href="/download-attachment?fid=341" target="_blank" title="Download this file (ExcelFilesWriterExamples.zip)">ExcelFilesWriterExamples.zip</a></td><td class="at_description">[Source code of Excel Files Writer Examples]</td><td class="at_file_size">4 kB</td></tr></tbody></table></div></div><input type="hidden" id="jcaid" value="554"><div id="jc"><h4>Add comment</h4><a id="addcomments" href="#addcomments"></a><form id="comments-form" name="comments-form" action="javascript:void(null);"><p><span><input id="comments-form-name" type="text" name="name" maxlength="20" size="22" tabindex="1" placeholder="Name" required=""> &nbsp;&nbsp;&nbsp; <input id="comments-form-email" type="text" name="email" value="" size="22" tabindex="2" placeholder="E-mail" required=""></span></p><p><span><textarea id="comments-form-comment" name="comment" cols="50" rows="6" tabindex="5" placeholder="comment" required=""></textarea><div class="grippie"></div></span></p><p><span><input class="checkbox" id="comments-form-subscribe" type="checkbox" name="subscribe" value="1" tabindex="5"><label for="comments-form-subscribe">Notify me of follow-up comments</label><br></span></p><p><span></span></p><div class="g-recaptcha" data-sitekey="6Leb1UsUAAAAAMz79FhT2G1eTmOUpvd2E82eUp2F"><div style="width: 304px; height: 78px;"><div><iframe title="reCAPTCHA" src="https://www.google.com/recaptcha/api2/anchor?ar=1&amp;k=6Leb1UsUAAAAAMz79FhT2G1eTmOUpvd2E82eUp2F&amp;co=aHR0cHM6Ly93d3cuY29kZWphdmEubmV0OjQ0Mw..&amp;hl=vi&amp;v=tftmXwdbgCvrXiHxr5HGbIaL&amp;size=normal&amp;cb=3la4fzt7ttms" width="304" height="78" role="presentation" name="a-88yccuxv16bl" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox"></iframe></div><textarea id="g-recaptcha-response" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div><iframe style="display: none;"></iframe></div><p></p><div id="comments-form-buttons"><div class="btn" id="comments-form-send"><button id="btnSendComment" title="Send (Ctrl+Enter)">Send</button></div><div class="btn" id="comments-form-cancel" style="display:none;"><div><a href="#" tabindex="8" onclick="return false;" title="Cancel">Cancel</a></div></div><div style="clear:both;"></div></div><div><input type="hidden" id="object_id" name="object_id" value="554"><input type="hidden" id="object_group" name="object_group" value="com_content"></div></form><div id="comments"><h4><a id="comment" name="comment">Comments</a><a class="refresh" href="#" title="Refresh comments list" id="btnRefreshComment1">&nbsp;</a></h4><div id="nav-top"><input type="hidden" id="totalPage" value="5"><span class="activepage"><b>1</b></span><span id="showPageTop2" class="page" onmouseover="this.className='hoverpage';" onmouseout="this.className='page';">2</span><span id="showPageTop3" class="page" onmouseover="this.className='hoverpage';" onmouseout="this.className='page';">3</span><span id="showPageTop4" class="page" onmouseover="this.className='hoverpage';" onmouseout="this.className='page';">4</span><span id="showPageTop5" class="page" onmouseover="this.className='hoverpage';" onmouseout="this.className='page';">5</span></div><div id="comments-list" class="comments-list"><div class="even" id="comment-item-18875"><div class="rbox"><div class="comment-box"><a class="comment-anchor" href="/coding/how-to-write-excel-files-in-java-using-apache-poi#comment-18875" id="comment-18875">#24</a><span class="comment-author">Nam</span><span class="comment-date">2021-08-21 06:24</span><div class="comment-body" id="comment-body-18875">Hi Mateus,<br>You should download from Apache POI's official page - or using Maven dependency.</div><span class="comments-buttons"><a href="#" class="qclnk" qid="18875">Quote</a></span></div><div class="clear"></div></div></div><div class="odd" id="comment-item-18873"><div class="rbox"><div class="comment-box"><a class="comment-anchor" href="/coding/how-to-write-excel-files-in-java-using-apache-poi#comment-18873" id="comment-18873">#23</a><span class="comment-author">Mateus</span><span class="comment-date">2021-08-21 04:59</span><div class="comment-body" id="comment-body-18873">Nice content, can you provide the jar files of th poi library</div><span class="comments-buttons"><a href="#" class="qclnk" qid="18873">Quote</a></span></div><div class="clear"></div></div></div><div class="even" id="comment-item-18604"><div class="rbox"><div class="comment-box"><a class="comment-anchor" href="/coding/how-to-write-excel-files-in-java-using-apache-poi#comment-18604" id="comment-18604">#22</a><span class="comment-author">Osman</span><span class="comment-date">2021-05-03 03:05</span><div class="comment-body" id="comment-body-18604">Hi Marcel,<br>If you need help you can write down I will help you</div><span class="comments-buttons"><a href="#" class="qclnk" qid="18604">Quote</a></span></div><div class="clear"></div></div></div><div class="odd" id="comment-item-18344"><div class="rbox"><div class="comment-box"><a class="comment-anchor" href="/coding/how-to-write-excel-files-in-java-using-apache-poi#comment-18344" id="comment-18344">#21</a><span class="comment-author">Jack Mar</span><span class="comment-date">2021-02-03 09:28</span><div class="comment-body" id="comment-body-18344">This is the best example on the top I can find. You did a great job! Much appreciated!</div><span class="comments-buttons"><a href="#" class="qclnk" qid="18344">Quote</a></span></div><div class="clear"></div></div></div><div class="even" id="comment-item-17707"><div class="rbox"><div class="comment-box"><a class="comment-anchor" href="/coding/how-to-write-excel-files-in-java-using-apache-poi#comment-17707" id="comment-17707">#20</a><span class="comment-author">Pujan KC</span><span class="comment-date">2020-06-26 13:55</span><div class="comment-body" id="comment-body-17707">Nice one! :) Clear and concise information.</div><span class="comments-buttons"><a href="#" class="qclnk" qid="17707">Quote</a></span></div><div class="clear"></div></div></div></div><div id="nav-bottom"><input type="hidden" id="totalPage" value="5"><span class="activepage"><b>1</b></span><span id="showPageBottom2" class="page" onmouseover="this.className='hoverpage';" onmouseout="this.className='page';">2</span><span id="showPageBottom3" class="page" onmouseover="this.className='hoverpage';" onmouseout="this.className='page';">3</span><span id="showPageBottom4" class="page" onmouseover="this.className='hoverpage';" onmouseout="this.className='page';">4</span><span id="showPageBottom5" class="page" onmouseover="this.className='hoverpage';" onmouseout="this.className='page';">5</span></div><div id="comments-list-footer"><a class="refresh" href="#" title="Refresh comments list" id="btnRefreshComment2">Refresh comments list</a></div></div></div></div>